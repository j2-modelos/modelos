<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Formatador</title>
    <script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="j2Conf.js"></script>
</head>
<body>
    <button id="actionReplace" style="width: 100%; height: 50px; font-weight: bold;" onclick='replacing();'>FORMATAR</button>
  <button id="actionReplace" style="width: 100%; height: 50px; font-weight: bold;" onclick='limping();'>LIMPAR</button>    
  <iframe id="mod" src="about::blank" style="width:100%; overflow:hidden; vertical-align: middle;" frameBorder="1"></iframe>
  <script>
      setInterval(function(){
          var body = document.body,
              html = document.documentElement;

          var height = Math.max( body.scrollHeight, body.offsetHeight, 
                                 html.clientHeight, html.scrollHeight, html.offsetHeight );
          
        document.getElementById('mod').height = html.clientHeight - 200;
      },100);
      document.getElementById('mod').contentDocument.body.setAttribute('contenteditable','');
      function limping(){
        var d = document.getElementById('mod').contentDocument;
        var es = d.body.childNodes;
        while(es.length)
            es[0].remove();
      }      
      function replacing(){
          var d = document.getElementById('mod').contentDocument;
          var es = d.body.childNodes;
          var masterP = d.createElement('span');
          masterP.style="font-family: 'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; font-size: 9pt; text-align: justify;";
          
        while(es.length){
            if(!(es[0].tagName)){
                es[0].remove();
                continue;
            }
            if(es[0].tagName==='br' || es[0].tagName==='BR' ){
                es[0].remove();
                continue;
            }
            
            while(es[0].firstChild){
                if(es[0].firstChild.tagName==='br' || es[0].firstChild.tagName==='BR' ){
                    es[0].firstChild.remove();
                    masterP.appendChild(document.createTextNode(' '));
                    continue;
                }
                masterP.appendChild(es[0].firstChild);
                masterP.appendChild(document.createTextNode(' '));
            }
            
            es[0].remove();
            
        }
        
        d.body.appendChild(masterP);
        
        var brs = d.getElementsByTagName('br');
        while(brs.length)
            brs[0].remove();
        brs = d.getElementsByTagName('BR');
        while(brs.length)
            brs[0].remove();
      }
  </script>
  <p id="presidenteAudiencia" style="margin: 6pt 0pt; font-family: &quot;Segoe UI&quot;,Tahoma,Geneva,Verdana,sans-serif; font-size: 10pt; text-align: justify;">
      <b>DICA</b>: Use a ferramente colar do Word para realizar a colagem de conteúdo no Termo de Audiência!
      <img src='res/img/PastHint.PNG'style='height: 45px;'/>
  </p>  
</body>
</html>